{{define "title"}} — {{.Project.Title}}{{end}}

{{define "content"}}
<a href="/projects" class="back-link"><i data-lucide="arrow-left" class="icon-sm"></i> Назад к проектам</a>

<div class="admin-project-header">
    <div>
        <h1 class="project-title">{{.Project.Title}}</h1>
        <div class="admin-project-meta">
            <span class="project-status-badge project-status-{{.Project.Status}}">
                {{if eq .Project.Status "pending"}}На модерации{{end}}
                {{if eq .Project.Status "active"}}Активен{{end}}
                {{if eq .Project.Status "hidden"}}Скрыт{{end}}
            </span>
            <span class="admin-muted">{{formatDate .Project.CreatedAt}}</span>
            {{if .Project.Author}}
            <span class="admin-muted">от {{.Project.Author.Name}}</span>
            {{end}}
        </div>
    </div>

    <div class="admin-project-actions">
        {{if ne .Project.Status "active"}}
        <form action="/api/projects/{{.Project.ID}}/approve" method="POST" class="inline-form">
            <input type="hidden" name="csrf_token" value="{{.CSRFToken}}">
            <button type="submit" class="btn btn-accept btn-sm">
                <i data-lucide="check" class="icon-sm"></i> Одобрить
            </button>
        </form>
        {{end}}
        {{if ne .Project.Status "hidden"}}
        <form action="/api/projects/{{.Project.ID}}/hide" method="POST" class="inline-form">
            <input type="hidden" name="csrf_token" value="{{.CSRFToken}}">
            <button type="submit" class="btn btn-secondary btn-sm">
                <i data-lucide="eye-off" class="icon-sm"></i> Скрыть
            </button>
        </form>
        {{end}}
        <form action="/api/projects/{{.Project.ID}}/delete" method="POST" class="inline-form" onsubmit="return confirm('Удалить проект?')">
            <input type="hidden" name="csrf_token" value="{{.CSRFToken}}">
            <button type="submit" class="btn btn-danger btn-sm">
                <i data-lucide="trash" class="icon-sm"></i> Удалить
            </button>
        </form>
    </div>
</div>

<div class="admin-project-body">
    <div class="project-body">
        <p>{{.Project.Description}}</p>
    </div>

    {{if .Project.Stack}}
    <div class="project-section">
        <h3 class="section-label"><i data-lucide="code" class="icon-sm"></i> Стек</h3>
        <div class="tag-list">
            {{range .Project.Stack}}
            <span class="tag tag-stack">{{.}}</span>
            {{end}}
        </div>
    </div>
    {{end}}

    {{if .Project.Roles}}
    <div class="project-section">
        <h3 class="section-label"><i data-lucide="users" class="icon-sm"></i> Роли</h3>
        <div class="tag-list">
            {{range .Project.Roles}}
            <span class="badge badge-{{.Slug}} badge-lg">{{.Name}}{{if gt .Count 1}} <span class="badge-count">x{{.Count}}</span>{{end}}</span>
            {{end}}
        </div>
    </div>
    {{end}}
</div>

{{if .Responses}}
<div class="responses-section">
    <h3 class="section-label"><i data-lucide="inbox" class="icon-sm"></i> Отклики ({{len .Responses}})</h3>
    <div class="responses-list">
        {{range .Responses}}
        <div class="response-card">
            <div class="response-user">
                <span class="author-avatar-sm">{{slice .User.Name 0 1}}</span>
                <div class="response-user-info">
                    <div class="response-name">{{.User.Name}}</div>
                    {{if .User.TgUsername}}
                    <span class="admin-tg">@{{.User.TgUsername}}</span>
                    {{end}}
                </div>
            </div>
            <span class="status-badge status-{{.Status}}">
                {{if eq .Status "pending"}}На рассмотрении{{end}}
                {{if eq .Status "accepted"}}Принят{{end}}
                {{if eq .Status "rejected"}}Отклонён{{end}}
            </span>
        </div>
        {{end}}
    </div>
</div>
{{end}}
{{end}}
